= Evaluation and Observability

[NOTE]
====
Persona: AI Engineer (primary). Also relevant: SRE/Platform Engineer.
====

[IMPORTANT]
.In this module
====
Learn a practical, high-level flow to combine agent evaluation with observability so you can measure, understand, and improve behavior over time.
====

[NOTE]
====
Estimated time: 15-20 minutes
====

== What you'll do...stretch goals!

* Plan evaluation scenarios and acceptance criteria
* Run evaluations and capture outputs, tool calls, and reasoning traces
* Instrument the service to emit logs/metrics/traces that align to evaluation steps
* Add guardrails/safety toggles and observe impact in both eval results and signals
* Establish dashboards/alerts to continuously monitor the same signals

== Flow overview

1. Define what “good” looks like for your agent (correctness, stability, latency, tool success)
2. Evaluate with representative prompts/tasks; record outputs and intermediate steps
3. Observe service-level signals (logs, metrics, traces) during the same runs
4. Compare results against criteria; identify where behavior or performance falls short
5. Tweak prompts, tools, or guardrails; re-run to verify improvements
6. Keep dashboards and alerts keyed to the same signals used in evaluation

== Success criteria

* The agent produces consistent answers across N repeated runs for a fixed prompt (tolerance defined by your team)
* Tool-call failures/timeouts trend downward after guardrail/safety changes
* Latency and error rates meet targets; traces show fewer retries and faster resolutions
* Approximate MTTR improvement: measure time from failure detection to GitHub issue creation before and after the finally step

Open up the following notebook in your workspace.


// lightbox - for images - FIXME need to make the include::partial$lightbox.hbs WORK
++++
<div id="myModal" class="modal">
    <span class="close cursor" onclick="closeModal()">&times;</span>
    <div class="modal-content" onclick="closeModal()">
        <!--suppress HtmlRequiredAltAttribute as this will be set when selecting the image via JavaScript,
        RequiredAttributes as src will be set by when selecting the image via JavaScript -->
        <img id="imageinmodal">
    </div>
</div>
<script>
    function openModal() {
        document.getElementById("myModal").style.display = "block";
        // use overflowY = hidden to prevent the body from scrolling when modal is visible
        // doesn't work with overscroll-behavior, as this would work only when the modal has a scrollbar
        document.getElementsByTagName("body")[0].style.overflowY = "hidden";
    }

    function closeModal() {
        document.getElementById("myModal").style.display = "none";
        document.getElementsByTagName("body")[0].style.overflowY = "auto";
    }

    document.querySelectorAll('.imageblock img').forEach(element => {
        if (element.closest('a') === null) {
            element.className += " lightbox";
            element.addEventListener('click', evt => {
                document.getElementById("imageinmodal").setAttribute("src", evt.currentTarget.getAttribute("src"))
                document.getElementById("imageinmodal").setAttribute("alt", evt.currentTarget.getAttribute("alt"))
                openModal();
            })
        }
    });
</script>
<style>
    /* The Modal (background) */
    .modal {
        display: none;
        position: fixed;
        z-index: 10;
        padding-top: 5vh;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        backdrop-filter: blur(3px);
        background-color: rgba(30, 30, 30, 0.8);
    }
    img.lightbox {
        cursor: pointer;
    }
    /* Modal Content */
    .modal-content {
        position: relative;
        margin: auto;
        padding: 0;
        width: 90%;
        max-height: 90vh;
        cursor: pointer;
    }

    .modal-content img {
        width: auto;
        height: auto;
        max-width: 90vw;
        max-height: 90vh;
        min-width: 90vw;
        min-height: 90vh;
        display: block;
        margin-right: auto;
        margin-left: auto;
        object-fit: contain;
    }

    /* The Close Button */
    .close {
        color: white;
        position: absolute;
        top: 10px;
        right: 25px;
        font-size: 35px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: #999;
        text-decoration: none;
        cursor: pointer;
    }
</style>
++++